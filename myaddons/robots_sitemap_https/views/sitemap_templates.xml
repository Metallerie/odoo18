<?xml version="1.0" encoding="UTF-8"?>
<odoo>
   <template id="website.sitemap_locs" name="Sitemap Locations with Images">
    <t t-foreach="locs" t-as="loc">
      <url>
        <loc><t t-esc="loc['loc']"/></loc>
        <t t-if="loc.get('title') and loc.get('image')">
          <image:image xmlns:image="http://www.google.com/schemas/sitemap-image/1.1">
            <image:loc><t t-esc="loc['image']"/></image:loc>
            <image:title><t t-esc="loc['title']"/></image:title>
          </image:image>
        </t>
        <t t-if="loc.get('lastmod')">
          <lastmod><t t-esc="loc['lastmod']"/></lastmod>
        </t>
      </url>
    </t>
  </template>

  <template id="website.sitemap_xml" name="Sitemap XML with images">
    <t t-set="ns_img" t-value="'http://www.google.com/schemas/sitemap-image/1.1'"/>
    <t t-set="xmlns" t-value="'http://www.sitemaps.org/schemas/sitemap/0.9'"/>
    <t t-raw="'''\n<urlset xmlns="%s" xmlns:image="%s">''' % (xmlns, ns_img)"/>
    <t t-raw="content"/>
    </urlset>
  </template>
  <!-- Bloc pour les URLs individuelles -->
  <template id="sitemap_locs" name="Sitemap Locations">
    <t t-foreach="locs" t-as="loc">
      <url>
        <loc><t t-esc="loc['loc']"/></loc>
        <t t-if="loc.get('image')">
          <image:image xmlns:image="http://www.google.com/schemas/sitemap-image/1.1">
            <image:loc><t t-esc="loc['image']"/></image:loc>
            <t t-if="loc.get('title')">
              <image:title><t t-esc="loc['title']"/></image:title>
            </t>
          </image:image>
        </t>
        <t t-if="loc.get('lastmod')">
          <lastmod><t t-esc="loc['lastmod']"/></lastmod>
        </t>
      </url>
    </t>
  </template>

  <!-- Enveloppe globale du sitemap -->
  <template id="sitemap_xml" name="Sitemap XML">
    <urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
            xmlns:image="http://www.google.com/schemas/sitemap-image/1.1">
      <t t-raw="content"/>
    </urlset>
  </template>

  <!-- Index si plusieurs pages de sitemap -->
  <template id="sitemap_index_xml" name="Sitemap Index">
    <sitemapindex xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
      <t t-foreach="pages" t-as="page">
        <sitemap>
          <loc><t t-esc="url_root"/>/sitemap-<t t-esc="page"/>.xml</loc>
        </sitemap>
      </t>
    </sitemapindex>
  </template>
</odoo>
