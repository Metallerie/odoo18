<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- Surcharge de la vue produit -->
        <template id="product_quantity_precision_surcharge" inherit_id="website_sale.product">
            <xpath expr="//input[@name='add_qty']" position="attributes">
                <!-- Calcul dynamique : 1 + (1 / 10^uom_precision) -->
                <attribute name="t-att-value">
                    "1.{}".format("0" * (combination_info.get('uom_precision', 0) - 1) + "1") if combination_info.get('uom_precision', 0) > 0 else "1.0"
                </attribute>
            </xpath>
        </template>

        <!-- Modifier le sélecteur de quantité dans le panier -->
        <template id="cart_quantity_surcharge" inherit_id="website_sale.cart_lines">
            <xpath expr="//input[contains(@class, 'js_quantity')]" position="attributes">
                <attribute name="t-att-data-uom_precision">line.product_id.uom_precision</attribute>
            </xpath>
        </template>
</odoo>
